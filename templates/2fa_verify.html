<!doctype html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>2FA Login · FjordLens</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body style="display:grid;min-height:100vh;place-items:center;">
  <form id="verifyForm" class="login-card" method="post" style="width:360px;max-width:92vw;border:1px solid var(--border);background:var(--panel);border-radius:12px;padding:16px;">
    <h2 style="margin:0 0 10px;">Indtast 2FA-kode</h2>
    {% if error %}<div class="err">{{ error }}</div>{% endif %}
    <div class="form-row">
      <label for="code">6-cifret kode</label>
      <input id="code" name="code" type="text" required inputmode="numeric" autocomplete="one-time-code" pattern="\d{6}" maxlength="6" placeholder="••••••">
    </div>
    <div class="form-row">
      <label for="remember_days" style="display:block;">Husk denne enhed</label>
      <div style="display:flex; gap:8px; align-items:center;">
        <label style="display:flex;align-items:center;gap:6px;"><input type="checkbox" name="remember" value="1"> Aktivér</label>
        <select id="remember_days" name="remember_days" class="select">
          <option value="0" {% if (remember_days or 0) == 0 %}selected{% endif %}>Hver gang</option>
          <option value="1" {% if (remember_days or 0) == 1 %}selected{% endif %}>1 dag</option>
          <option value="3" {% if (remember_days or 0) == 3 %}selected{% endif %}>3 dage</option>
          <option value="5" {% if (remember_days or 0) == 5 %}selected{% endif %}>5 dage</option>
          <option value="7" {% if (remember_days or 0) == 7 %}selected{% endif %}>7 dage</option>
        </select>
      </div>
    </div>
    <div class="actions">
      <a class="mini-link" href="/login">Tilbage</a>
      <button class="btn primary" type="submit">Bekræft</button>
    </div>
  </form>
  <script>
    (function(){
      const input = document.getElementById('code');
      const form = document.getElementById('verifyForm');
      if (!input || !form) return;
      input.addEventListener('input', () => {
        const v = (input.value || '').replace(/\D/g, '').slice(0,6);
        if (v !== input.value) input.value = v;
        if (v.length === 6) {
          try { form.requestSubmit ? form.requestSubmit() : form.submit(); } catch(e) { form.submit(); }
        }
      });
      input.focus();
    })();
  </script>
</body>
</html>
