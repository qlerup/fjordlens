<!doctype html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>FjordLens</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body>
  <div class="app-shell">
    <aside class="sidebar">
      <div class="logo">
        <div class="logo-dot"></div>
        <div>
          <div class="logo-title">FjordLens</div>
          <div class="logo-sub">Synology Starter</div>
        </div>
      </div>

      <nav class="nav">
        <button class="nav-item active" data-view="library">üì∑ Bibliotek</button>
        <button class="nav-item" data-view="favorites">‚≠ê Favoritter</button>
        <button class="nav-item" data-view="steder">üìç Steder</button>
        <button class="nav-item" data-view="kameraer">üì∏ Kameraer</button>
        <button class="nav-item" data-view="mapper">üóÇÔ∏è Mapper</button>
        <button class="nav-item" data-view="personer">üôÇ Personer</button>
        <button class="nav-item" data-view="logs">üßæ Logs</button>
      </nav>

      <div class="sidebar-card">
        <div class="sidebar-card-title">AI-s√∏gning (klar til n√¶ste trin)</div>
        <p>Datafelter og API er gjort klar til ONNX/CLIP og ansigtsgenkendelse.</p>
        <p class="hint">Du kan allerede s√∏ge p√• dansk i metadata og placeholder-tags.</p>
      </div>

      <div class="sidebar-card">
        <div class="sidebar-card-title">Live logs</div>
        <div style="display:flex; gap:6px; margin-bottom:6px;">
          <button id="logsStart" class="btn">Start</button>
          <button id="logsClear" class="btn">Ryd</button>
        </div>
        <pre id="liveLogs" class="raw-meta" style="max-height:220px;"></pre>
      </div>

      <div class="sidebar-footer">
        <a href="/api/health" target="_blank" class="mini-link">API health</a>
        <a href="/api/filters" target="_blank" class="mini-link">Filtre</a>
      </div>
    </aside>

    <main class="main">
      <header class="topbar">
        <div class="search-wrap">
          <input id="searchInput" type="text" placeholder="S√∏g p√• dansk: strand, bil, skov, kamera, dato, filnavn...">
        </div>
        <select id="sortSelect" class="select">
          <option value="date_desc">Nyeste f√∏rst</option>
          <option value="date_asc">√Üldste f√∏rst</option>
          <option value="name_asc">Navn A-√Ö</option>
          <option value="name_desc">Navn √Ö-A</option>
          <option value="size_desc">St√∏rst f√∏rst</option>
          <option value="size_asc">Mindst f√∏rst</option>
        </select>
        <button id="scanBtn" class="btn primary">Scan bibliotek</button>
        <button id="rescanBtn" class="btn">Rescan metadata</button>
      </header>

      <section class="content-header">
        <div>
          <h1 id="viewTitle">Bibliotek</h1>
          <p id="viewSubtitle">Scan din fotomappe og s√∏g/sort√©r i metadata</p>
        </div>
        <div class="stats">
          <div class="stat-card">
            <span class="stat-label">Billeder</span>
            <span class="stat-value" id="photoCount">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Favoritter</span>
            <span class="stat-value" id="favoriteCount">0</span>
          </div>
          <div class="stat-card">
            <span class="stat-label">Valgt</span>
            <span class="stat-value" id="selectedCount">0</span>
          </div>
        </div>
      </section>

      <section id="statusBar" class="status hidden"></section>
      <section id="emptyState" class="empty hidden"></section>
      <section id="galleryGrid" class="gallery-grid"></section>

      <section id="logsPanel" class="hidden">
        <div class="status" style="margin-bottom:8px; display:flex; gap:8px; align-items:center;">
          <strong>Logs:</strong>
          <button id="mainLogsStart" class="btn">Start</button>
          <button id="mainLogsClear" class="btn">Ryd</button>
        </div>
        <pre id="mainLogs" class="raw-meta" style="height:60vh;"></pre>
      </section>
    </main>

    <aside class="detail-panel">
      <div id="detailEmpty" class="detail-empty">
        <p>V√¶lg et billede for at se detaljer og metadata.</p>
      </div>

      <div id="detailContent" class="detail-content hidden">
        <div class="detail-thumb-wrap">
          <img id="detailThumb" alt="Thumbnail">
        </div>

        <div class="detail-header">
          <h3 id="detailName">-</h3>
          <button id="favoriteBtn" class="icon-btn" title="Favorit">‚òÜ</button>
        </div>

        <div class="detail-path" id="detailPath">-</div>

        <div class="detail-list">
          <div class="detail-row"><span>Dato</span><strong id="detailDate">-</strong></div>
          <div class="detail-row"><span>St√∏rrelse</span><strong id="detailSize">-</strong></div>
          <div class="detail-row"><span>Dimensioner</span><strong id="detailDims">-</strong></div>
          <div class="detail-row"><span>Kamera</span><strong id="detailCamera">-</strong></div>
          <div class="detail-row"><span>Linse</span><strong id="detailLens">-</strong></div>
          <div class="detail-row"><span>GPS</span><strong id="detailGps">-</strong></div>
          <div class="detail-row"><span>AI tags</span><strong id="detailAiTags">-</strong></div>
        </div>

        <div class="accordion">
          <button id="toggleRawBtn" class="btn ghost full">Vis r√• metadata (JSON)</button>
          <pre id="rawMeta" class="raw-meta hidden"></pre>
        </div>
      </div>
    </aside>
  </div>

  <!-- Image viewer modal -->
  <div id="viewer" class="hidden" style="position:fixed;inset:0;background:rgba(0,0,0,0.85);display:flex;align-items:center;justify-content:center;z-index:9999;">
    <button id="viewerPrev" class="btn" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);">‚ü®</button>
    <img id="viewerImg" alt="" style="max-width:92vw;max-height:90vh;border-radius:12px;border:1px solid rgba(255,255,255,0.2);" />
    <button id="viewerNext" class="btn" style="position:absolute;right:12px;top:50%;transform:translateY(-50%);">‚ü©</button>
    <button id="viewerClose" class="btn" style="position:absolute;right:12px;top:12px;">Luk</button>
  </div>
  <script src="{{ url_for('static', filename='app.js') }}"></script>
</body>
</html>
